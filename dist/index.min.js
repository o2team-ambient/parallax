!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.ATAmbient=t()}(this,function(){"use strict";!function(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css","top"===n&&i.firstChild?i.insertBefore(a,i.firstChild):i.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}('@charset "UTF-8";\n/* 自定义样式 */\n/**\n * 样式重置，将不会被打包进代码包\n */\n* {\n  -webkit-tap-highlight-color: transparent;\n  outline: 0;\n  margin: 0;\n  padding: 0;\n  vertical-align: baseline; }\n\nbody {\n  margin: 0;\n  padding: 0;\n  vertical-align: baseline; }\n\n.o2team_ambient_main {\n  z-index: 999;\n  pointer-events: none;\n  height: 1000px; }\n');var e="parallax".toUpperCase(),n="O2_AMBIENT_".concat(e,"_MAIN"),t="O2_AMBIENT_".concat(e,"_INIT"),a="O2_AMBIENT_".concat(e,"_CONFIG");function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}!function(){for(var r=0,e=["ms","moz","webkit","o"],t=0;t<e.length&&!window.requestAnimationFrame;++t)window.requestAnimationFrame=window["".concat(e[t],"RequestAnimationFrame")],window.cancelAnimationFrame=window["".concat(e[t],"CancelAnimationFrame")]||window["".concat(e[t],"CancelRequestAnimationFrame")];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,t){var n=(new Date).getTime(),i=Math.max(0,16-(n-r)),a=window.setTimeout(function(){e(n+i)},i);return r=n+i,a}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}(),function(){function a(e,t){return e.zIndex===t.zIndex?0:e.zIndex<t.zIndex?-1:1}function t(){this.width=this.width?this.width:this.image.width,this.height=this.height?this.height:this.image.height}var o,n,s=window,i=document,e=i.documentElement,r=i.body,c=s.requestAnimationFrame||s.mozRequestAnimationFrame||s.webkitRequestAnimationFrame||s.msRequestAnimationFrame||s.oRequestAnimationFrame||function(e){s.setTimeout(e,20)},h=function(){},l={tracking:"scroll",trackingInvert:!1,x:0,y:0,damping:1,canvas:void 0,className:"",parent:document.body,elements:void 0,animating:!0,fullscreen:!0,preRender:h,postRender:h},d=!1,u=0,m=0,g=function(){u=e.scrollLeft||r.scrollLeft,m=e.scrollTop||r.scrollTop},f=!1,v=0,x=0,p=function(e){v=e.touches?e.touches[0].clientX:e.clientX,x=e.touches?e.touches[0].clientY:e.clientY};if(!s.CanvasRenderingContext2D)return s.Canvallax=function(){return!1};s.Canvallax=function e(t){if(!(this instanceof e))return new e(t);var n=this;return e.extend(this,l,t),n.canvas=n.canvas||i.createElement("canvas"),n.canvas.className+=" canvallax "+n.className,n.parent.insertBefore(n.canvas,n.parent.firstChild),n.fullscreen?(n.resizeFullscreen(),s.addEventListener("resize",n.resizeFullscreen.bind(n))):n.resize(n.width,n.height),n.ctx=n.canvas.getContext("2d"),n.elements=[],t&&t.elements&&n.addElements(t.elements),n.damping=!n.damping||n.damping<1?1:n.damping,n.render(),n},Canvallax.prototype={_x:0,_y:0,add:function(e){for(var t=e.length?e:arguments,n=t.length,i=0;i<n;i++)this.elements.push(t[i]);return this.elements.sort(a),this},remove:function(e){var t=this.elements.indexOf(e);return-1<t&&this.elements.splice(t,1),this},render:function(){var e=this,t=0,n=e.elements.length,i=0,a=0,r=e.fullscreen||"pointer"!==e.tracking;for(e.animating&&(e.animating=c(e.render.bind(e))),e.tracking&&("scroll"===e.tracking?(d||(d=!0,g(),s.addEventListener("scroll",g),s.addEventListener("touchmove",g)),e.x=u,e.y=m):"pointer"===e.tracking&&(f||(f=!0,s.addEventListener("mousemove",p),s.addEventListener("touchmove",p)),r||(i=e.canvas.offsetLeft,a=e.canvas.offsetTop,r=i<=v&&v<=i+e.width&&a<=x&&x<=a+e.height),r&&(e.x=-v+i,e.y=-x+a)),e.x=!r||!0!==e.trackingInvert&&"invertx"!==e.trackingInvert?e.x:-e.x,e.y=!r||!0!==e.trackingInvert&&"inverty"!==e.trackingInvert?e.y:-e.y),e._x+=(-e.x-e._x)/e.damping,e._y+=(-e.y-e._y)/e.damping,e.ctx.clearRect(0,0,e.width,e.height),e.preRender(e.ctx,e);t<n;t++)e.ctx.save(),e.elements[t]._render(e.ctx,e),e.ctx.restore();return e.postRender(e.ctx,e),this},resize:function(e,t){return this.width=this.canvas.width=e,this.height=this.canvas.height=t,this},resizeFullscreen:function(){return this.resize(s.innerWidth,s.innerHeight)},play:function(){return this.animating=!0,this.render()},pause:function(){return this.animating=!1,this}},Canvallax.createElement=(o=Math.PI/180,n={x:0,y:0,distance:1,fixed:!1,opacity:1,fill:!1,stroke:!1,lineWidth:!1,transformOrigin:"center center",scale:1,rotation:0,preRender:h,render:h,postRender:h,init:h,crop:!1,getTransformPoint:function(){var e=this,t=e.transformOrigin.split(" "),n={x:e.x,y:e.y};return"center"===t[0]?n.x+=e.width?e.width/2:e.size:"right"===t[0]&&(n.x+=e.width?e.width:2*e.size),"center"===t[1]?n.y+=e.height?e.height/2:e.size:"bottom"===t[1]&&(n.y+=e.height?e.height:2*e.size),n},_render:function(e,t){var n=this,i=n.distance||1,a=t._x,r=t._y,s=function(e){var t=function(e){return[e.transformOrigin,e.x,e.y,e.width,e.height,e.size].join(" ")}(e);return e._pointCache&&e._pointChecksum===t||(e._pointCache=e.getTransformPoint(),e._pointChecksum=t),e._pointCache}(n);return n.preRender.call(n,e,t),n.blend&&(t.ctx.globalCompositeOperation=n.blend),t.ctx.globalAlpha=n.opacity,t.ctx.translate(s.x,s.y),!1===n.scale?(a*=i,r*=i):t.ctx.scale(i,i),n.fixed||t.ctx.translate(a,r),!1!==n.scale&&t.ctx.scale(n.scale,n.scale),n.rotation&&t.ctx.rotate(n.rotation*o),t.ctx.translate(-s.x,-s.y),n.crop&&(e.beginPath(),"function"==typeof n.crop?n.crop.call(n,e,t):e.rect(n.crop.x,n.crop.y,n.crop.width,n.crop.height),e.clip(),e.closePath()),n.outline&&(e.beginPath(),e.rect(n.x,n.y,n.width||2*n.size,n.height||2*n.size),e.closePath(),e.strokeStyle=n.outline,e.stroke()),n.render.call(n,e,t),this.fill&&(e.fillStyle=this.fill,e.fill()),this.stroke&&(this.lineWidth&&(e.lineWidth=this.lineWidth),e.strokeStyle=this.stroke,e.stroke()),n.postRender.call(n,e,t),n},clone:function(e){e=Canvallax.extend({},this,e);return new this.constructor(e)}},function(e){function t(e){return this instanceof t?(Canvallax.extend(this,e),this.init.apply(this,arguments),this):new t(e)}return((t.prototype=Canvallax.extend({},n,e)).constructor=t).clone=t.prototype.clone,t}),Canvallax.extend=function(e){e=e||{};var t=arguments.length,n=1;for(1===arguments.length&&(e=this,n=0);n<t;n++)if(arguments[n])for(var i in arguments[n])arguments[n].hasOwnProperty(i)&&(e[i]=arguments[n][i]);return e};var w=2*Math.PI;Canvallax.Circle=Canvallax.createElement({size:20,render:function(e){e.beginPath(),e.arc(this.x+this.size,this.y+this.size,this.size,0,w),e.closePath()}}),Canvallax.Element=Canvallax.createElement(),Canvallax.Image=Canvallax.createElement({src:null,image:null,width:null,height:null,init:function(e){this.image=this.image&&1===this.image.nodeType?this.image:e&&1===e.nodeType?e:new Image,t.bind(this)(),this.image.onload=t.bind(this),this.image.src=this.image.src||e.src||e},render:function(e){this.image&&e.drawImage(this.image,this.x,this.y,this.width,this.height)}});w=2*Math.PI;Canvallax.Polygon=Canvallax.createElement({sides:6,size:20,render:function(e){var t=this.sides;for(e.translate(this.x+this.size,this.y+this.size),e.beginPath(),e.moveTo(this.size,0);t--;)e.lineTo(this.size*Math.cos(t*w/this.sides),this.size*Math.sin(t*w/this.sides));e.closePath()}}),Canvallax.Rectangle=Canvallax.createElement({width:100,height:100,render:function(e){e.beginPath(),e.rect(this.x,this.y,this.width,this.height),e.closePath()}})}();var r=function(){function m(e){var t=e.textures,n=void 0===t?[]:t,i=e.particleNumber,a=void 0===i?400:i,r=e.width,s=void 0===r?document.body.clientWidth:r,o=e.height,c=void 0===o?document.body.clientHeight:o,h=e.damping,l=void 0===h?20:h,d=e.isFullScreen,u=void 0===d||d;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,m),this.width=s,this.height=c,this.particleNumber=a,this.textures=n,this.damping=l,this.isFullScreen=u,this.init()}return function(e,t,n){t&&i(e.prototype,t),n&&i(e,n)}(m,[{key:"init",value:function(){var n=this;this.canvallax=Canvallax({damping:this.damping,parent:document.querySelector(".o2team_ambient_main"),fullscreen:!1,width:this.width,height:this.height}),this.isFullScreen&&window.addEventListener("resize",function(){var e=document.body.clientWidth===n.width?n.width:document.body.clientWidth,t=document.body.clientHeight===n.height?n.height:document.body.clientHeight;n.canvallax.resize(e,t)}),this.create()}},{key:"create",value:function(){for(var e,t=[],n=this.particleNumber,i=0,a=this.width,r=this.height,s=this.textures.length;i<n;i++){e=this._randomRange(.25,.9);var o=void 0;if(s){var c=Math.round(this._randomRange(0,this.textures.length-1));o=Canvallax.Image({x:Math.random()*a*(2-e),y:Math.random()*r*(2-e),distance:e,size:2,src:this.textures[c]})}else o=Canvallax.Circle({x:Math.random()*a*(2-e),y:Math.random()*r*(2-e),distance:e,size:2,fill:"#FFF"});t.push(o)}this.canvallax.add(t)}},{key:"reset",value:function(){var n=this,i=window[a];Object.keys(i).forEach(function(e){"textures"===e?Object.keys(i.textures).forEach(function(e,t){/\.(png|jpe?g|gif|bpm|svg)(\?.*)?$/.test(i.textures[e])&&(n.textures[t]=i.textures[e])}):n[e]=i[e]}),document.querySelector(".o2team_ambient_main").removeChild(this.canvallax.canvas),this.init()}},{key:"resize",value:function(e,t){this.canvallax.resize(e,t)}},{key:"_randomRange",value:function(e,t){return Math.random()*(t-e)+e}}]),m}(),s=document.querySelector(".o2team_ambient_main");function o(e){var t=new r(e);window[n]=t}return s||((s=document.createElement("div")).setAttribute("class","o2team_ambient_main"),s.setAttribute("id","o2team_ambient_main"),document.body.insertAdjacentElement("beforeend",s)),s.addEventListener("click",function(){s.style.display="none"}),window[t]=o,window[a]={particleNumber:20,fullScreen:!0,textures:["//storage.jd.com/o2images/34cafbecea6d24c062ea5177adbb42d1.png","//storage.jd.com/o2images/92da6c3db10b3984491a6089f58da2bb.png"]},function(t){t&&Object.keys(window[a]).forEach(function(e){void 0!==t[e]&&(window[a][e]=t[e])}),o(window[a])}});
//# sourceMappingURL=index.min.js.map
